---
layout: docco
title: OACVideoAnnotator/code/src/outro.coffee.html
---
<div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../index.html" class="source"><span class="file_name">README</span></a><a href="../src/application.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">application.coffee</span></a><a href="../src/component.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">component.coffee</span></a><a href="../src/controller.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">controller.coffee</span></a><a href="../src/driver-framework.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">driver-framework.coffee</span></a><a href="../src/drivers/dummy.coffee.html" class="source "><span class="base_path">src / drivers / </span><span class="file_name">dummy.coffee</span></a><a href="../src/drivers/html5.coffee.html" class="source "><span class="base_path">src / drivers / </span><span class="file_name">html5.coffee</span></a><a href="../src/intro.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">intro.coffee</span></a><a href="../src/outro.coffee.html" class="source selected"><span class="base_path">src / </span><span class="file_name">outro.coffee</span></a><a href="../src/presentation.coffee.html" class="source "><span class="base_path">src / </span><span class="file_name">presentation.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>outro.coffee</h1><div class="filepath">src/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre>  
<span class="p">)(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nx">MITHGrid</span><span class="p">,</span> <span class="nx">OAC</span><span class="p">)</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><h1>Default Configurations</h1>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><h2>Application</h2>

<p>The Video Annotator core application has the basic set of components needed to provide video annotation.</p>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Application&quot;</span><span class="p">,</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><h3>Controllers</h3>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">controllers:</span>
    <span class="nv">canvas:</span>
      <span class="nv">type: </span><span class="nx">OAC</span><span class="p">.</span><span class="nx">Client</span><span class="p">.</span><span class="nx">StreamingVideo</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">CanvasClickController</span>
      <span class="nv">selectors:</span>
        <span class="nv">svgwrapper: </span><span class="s">&#39;&#39;</span>
    <span class="nv">selectShape:</span>
      <span class="nv">type: </span><span class="nx">OAC</span><span class="p">.</span><span class="nx">Client</span><span class="p">.</span><span class="nx">StreamingVideo</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">Select</span>
      <span class="nv">selectors:</span>
        <span class="nv">raphael: </span><span class="s">&#39;&#39;</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><h3>Variables</h3>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">variables:</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p><strong>ActiveAnnotation</strong> holds the item ID of the annotation currently receiving selection focus.</p>

<ul>
<li>setActiveAnnotation(id) sets the id</li>
<li>getActiveAnnotation() returns the id</li>
<li>lockActiveAnnotation() keeps it from being changed</li>
<li>unlockActiveAnnotation() undoes a previous call to lockActiveAnnotation()</li>
<li>events.onActiveAnnotationChange fires when the ActiveAnnotation value changes</li>
</ul>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">ActiveAnnotation:</span>
      <span class="o">is:</span> <span class="s">&#39;rwl&#39;</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p><strong>CurrentTime</strong> holds the current position of the video play head in seconds. The value defaults to 0 seconds.</p>

<ul>
<li>setCurrentTime(time) sets the play head position for the annotation client (does not affect the player)</li>
<li>getCurrentTime() returns the current play head position</li>
<li>events.onCurrentTimeChange fires when the CurrentTime value changes</li>
</ul>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">CurrentTime:</span>
      <span class="o">is:</span> <span class="s">&#39;rw&#39;</span>
      <span class="s">&quot;default&quot;</span><span class="o">:</span> <span class="mi">0</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p><strong>TimeEasement</strong> holds the number of seconds an annotation eases in or out of full view.</p>

<ul>
<li>setTimeEasement(t)</li>
<li>getTimeEasement()</li>
<li>events.onTimeEasementChange</li>
</ul>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">TimeEasement:</span>
      <span class="o">is:</span> <span class="s">&#39;rw&#39;</span><span class="p">,</span>
      <span class="s">&quot;default&quot;</span><span class="o">:</span> <span class="mi">5</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p><strong>CurrentMode</strong> holds the current interaction mode for the annotation client. Values may be a shape type,
"Watch", or "Select".</p>

<ul>
<li>setCurrentMode(mode) sets the annotation client mode</li>
<li>getCurrentMode() returns the current annotation client mode</li>
<li>events.onCurrentModeChange fires when the CurrentMode value changes</li>
</ul>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">CurrentMode:</span>
      <span class="o">is:</span> <span class="s">&#39;rw&#39;</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><h3>Data Views</h3>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">dataViews:</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p><strong>currentAnnotations</strong> pages a range of times through the annotation store selecting those
annotations which have a time range (.npt_start through .npt_end) that fall within the time
range set.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">currentAnnotations:</span>
      <span class="nv">dataStore: </span><span class="s">&#39;canvas&#39;</span>
      <span class="nv">type: </span><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">RangePager</span>
      <span class="nv">leftExpressions: </span><span class="p">[</span> <span class="s">&#39;.npt_start&#39;</span> <span class="p">]</span>
      <span class="nv">rightExpressions: </span><span class="p">[</span> <span class="s">&#39;.npt_end&#39;</span> <span class="p">]</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><h3>Data Store</h3>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">dataStores:</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><p><strong>canvas</strong> holds all of the annotation data for the client.</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nv">canvas:</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><h4>Types</h4>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">types:</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><p>All annotation items are of type "Annotation"</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">Annotation: </span><span class="p">{}</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><h4>Properties</h4>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">properties:</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><p>The following properties are understood by the annotation client:</p>
</td><td class="code"><div class="highlight"><pre>        </pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><ul>
<li>bodyContent holds the byte stream associated with the annotation body</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">bodyContent:</span>
          <span class="nv">valueType: </span><span class="s">&#39;text&#39;</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><ul>
<li>bodyType indicates what kind of body the annotation associates with the target (e.g., Text)</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">bodyType:</span>
          <span class="nv">valueType: </span><span class="s">&#39;text&#39;</span>
        </pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><ul>
<li>the play head position at which this annotation ceases being active/current</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">npt_end: </span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><ul>
<li>the play head position at which this annotation becomes active/current</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">npt_start:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><ul>
<li>shapeType indicates which shape is used as the SVG constraint within the frame (e.g., Rectangle or Ellipse)</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">shapeType:</span>
          <span class="nv">valueType: </span><span class="s">&#39;text&#39;</span>
        </pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><ul>
<li>targetURI points to the annotation target video without time constraints</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">targetURI:</span>
          <span class="nv">valueType: </span><span class="s">&#39;uri&#39;</span>

        </pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>The following properties are used by the Rectangle and Ellipse shape types:</p>
</td><td class="code"><div class="highlight"><pre>        </pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><ul>
<li>h</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">h:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><ul>
<li>targetHeight</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">targetHeight:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><ul>
<li>targetWidth</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">targetWidth:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-28"><td class="docs"><div class="pilwrap"><a href="#section-28" class="pilcrow">&#182;</a></div><ul>
<li>w</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">w:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-29"><td class="docs"><div class="pilwrap"><a href="#section-29" class="pilcrow">&#182;</a></div><ul>
<li>x</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">x:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span></pre></div></td></tr><tr id="section-30"><td class="docs"><div class="pilwrap"><a href="#section-30" class="pilcrow">&#182;</a></div><ul>
<li>y</li>
</ul>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">y:</span>
          <span class="nv">valueType: </span><span class="s">&#39;numeric&#39;</span>
          </pre></div></td></tr><tr id="section-31"><td class="docs"><div class="pilwrap"><a href="#section-31" class="pilcrow">&#182;</a></div><h3>Presentations</h3>

<p>We go ahead and define the overlay that will show the annotation shapes over the video. Any other presentation
must be configured outside this application (or as a sub-class).</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">presentations: </span>
    <span class="nv">raphsvg:</span>
      <span class="nv">type: </span><span class="nx">OAC</span><span class="p">.</span><span class="nx">Client</span><span class="p">.</span><span class="nx">StreamingVideo</span><span class="p">.</span><span class="nx">Presentation</span><span class="p">.</span><span class="nx">RaphaelCanvas</span>
      <span class="nv">container: </span><span class="s">&quot;.canvas&quot;</span>
      <span class="nv">lenses: </span><span class="p">{}</span>
      <span class="nv">lensKey: </span><span class="p">[</span><span class="s">&#39;.shapeType&#39;</span><span class="p">]</span>
      <span class="nv">dataView: </span><span class="s">&#39;currentAnnotations&#39;</span></pre></div></td></tr><tr id="section-32"><td class="docs"><div class="pilwrap"><a href="#section-32" class="pilcrow">&#182;</a></div><p>The controllers are configured for the application and passed in to the presentation's
initInstance method as named here.</p>
</td><td class="code"><div class="highlight"><pre>      <span class="nv">controllers:</span>
        <span class="nv">canvas: </span><span class="s">&quot;canvas&quot;</span></pre></div></td></tr><tr id="section-33"><td class="docs"><div class="pilwrap"><a href="#section-33" class="pilcrow">&#182;</a></div><h3>View Setup</h3>

<p>We create a simple <code>&lt;div/&gt;</code> to hold the Raphaël canvas. Everything else in the UI is provided by a super class
or the environment in which this application is being used.</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nv">viewSetup: </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    &lt;div class=&quot;canvas&quot;&gt;&lt;/div&gt;</span>
<span class="s">  &quot;&quot;&quot;</span></pre></div></td></tr><tr id="section-34"><td class="docs"><div class="pilwrap"><a href="#section-34" class="pilcrow">&#182;</a></div><h2>Component.ShapeCreateBox</h2>

<p>Instances of this component will have the following event:</p>

<ul>
<li>onNewShape</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Component.ShapeCreateBox&quot;</span><span class="p">,</span>
  <span class="nv">bind:</span>
    <span class="nv">events:</span>
      <span class="nv">onNewShape: </span><span class="kc">null</span>
            </pre></div></td></tr><tr id="section-35"><td class="docs"><div class="pilwrap"><a href="#section-35" class="pilcrow">&#182;</a></div><h2>Component.ShapeEditBox</h2>

<p>By default, this component will have eight handles around the edges of the bounding box and a handle in the center.</p>

<p>Instances of this component will have the following events:</p>

<ul>
<li>onResize</li>
<li>onMove</li>
<li>onDelete</li>
<li>onFocus</li>
<li>onUnfocus</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Component.ShapeEditBox&quot;</span><span class="p">,</span>
  <span class="nv">dirs: </span><span class="p">[</span><span class="s">&#39;ul&#39;</span><span class="p">,</span> <span class="s">&#39;top&#39;</span><span class="p">,</span> <span class="s">&#39;ur&#39;</span><span class="p">,</span> <span class="s">&#39;lft&#39;</span><span class="p">,</span> <span class="s">&#39;lr&#39;</span><span class="p">,</span> <span class="s">&#39;btm&#39;</span><span class="p">,</span> <span class="s">&#39;ll&#39;</span><span class="p">,</span> <span class="s">&#39;rgt&#39;</span><span class="p">,</span> <span class="s">&#39;mid&#39;</span><span class="p">]</span>
  <span class="nv">events:</span>
    <span class="nv">onResize: </span><span class="kc">null</span>
    <span class="nv">onMove: </span><span class="kc">null</span>
    <span class="nv">onDelete: </span><span class="kc">null</span>
    <span class="nv">onFocus: </span><span class="kc">null</span>
    <span class="nv">onUnfocus: </span><span class="kc">null</span></pre></div></td></tr><tr id="section-36"><td class="docs"><div class="pilwrap"><a href="#section-36" class="pilcrow">&#182;</a></div><h2>Controller.CanvasClickController</h2>

<p>Bindings created by this controller will have the following events:</p>

<ul>
<li>onShapeStart</li>
<li>onShapeDrag</li>
<li>onShapeDone</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Controller.CanvasClickController&quot;</span><span class="p">,</span>
  <span class="nv">bind:</span>
    <span class="nv">events:</span>
      <span class="nv">onShapeStart: </span><span class="kc">null</span>
      <span class="nv">onShapeDrag: </span><span class="kc">null</span>
      <span class="nv">onShapeDone: </span><span class="kc">null</span></pre></div></td></tr><tr id="section-37"><td class="docs"><div class="pilwrap"><a href="#section-37" class="pilcrow">&#182;</a></div><h2>Controller.Drag</h2>

<p>Bindings created by this controller will have the following events:</p>

<ul>
<li>onFocus</li>
<li>onUnfocus</li>
<li>onUpdate</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Controller.Drag&quot;</span><span class="p">,</span>
  <span class="nv">bind:</span>
    <span class="nv">events:</span>
      <span class="nv">onFocus: </span><span class="kc">null</span>
      <span class="nv">onUnfocus: </span><span class="kc">null</span>
      <span class="nv">onUpdate: </span><span class="kc">null</span></pre></div></td></tr><tr id="section-38"><td class="docs"><div class="pilwrap"><a href="#section-38" class="pilcrow">&#182;</a></div><h2>Controller.Select</h2>

<p>This controller accepts the <code>isSelectable</code> configuration option as a function that is called to see
if the <code>onSelect</code> event should fire.</p>

<p>Bindings created by this controller will have the following event:</p>

<ul>
<li>onSelect</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Controller.Select&quot;</span><span class="p">,</span>
  <span class="nv">bind:</span>
    <span class="nv">events:</span>
      <span class="nv">onSelect: </span><span class="kc">null</span>
  <span class="nv">isSelectable: </span><span class="o">-&gt;</span> <span class="kc">true</span></pre></div></td></tr><tr id="section-39"><td class="docs"><div class="pilwrap"><a href="#section-39" class="pilcrow">&#182;</a></div><h2>Player.DriverBinding</h2>

<p>All driver bindings associating a driver object with a DOM player object have the following events:</p>

<ul>
<li>onResize</li>
<li>onPlayheadUpdate</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nx">MITHGrid</span><span class="p">.</span><span class="nx">defaults</span> <span class="s">&quot;OAC.Client.StreamingVideo.Player.DriverBinding&quot;</span><span class="p">,</span>
  <span class="nv">events:</span>
    <span class="nv">onResize: </span><span class="kc">null</span>
    <span class="nv">onPlayheadUpdate: </span><span class="kc">null</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Mon May 14 2012 08:26:20 GMT-0400 (EDT)  </div><div id="projectname"><a href="../index.html">Video Annotator</a></div></div>